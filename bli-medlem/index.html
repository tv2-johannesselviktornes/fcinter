<!DOCTYPE html>
<html>
	<head>
		<title>Innmelding</title>
	</head>
	<body>
		<form id="membership-form" class="needs-validation" novalidate>
  <div class="mb-3">
    <label for="fullName" class="form-label">Fullt navn</label>
    <input type="text" class="form-control" id="fullName" name="fullName" required>
    <div class="invalid-feedback">Please provide your name.</div>
  </div>
  
  <div class="mb-3">
    <label for="email" class="form-label">E-post</label>
    <input type="email" class="form-control" id="email" name="email" required>
    <div class="invalid-feedback">Skriv inn en gyldig e-postadresse</div>
  </div>
  
  <!-- Add any other fields you need -->
  
  <div class="mb-3">
    <div class="g-recaptcha" data-sitekey="6Ldi8RITAAAAAI6i7dITHSvIl4q5n0Q2PaqxUUUP"></div>
  </div>
  
  <button type="submit" class="btn btn-primary">Send inn</button>
  
  <div id="formResult" class="mt-3"></div>
</form>

<script src="https://www.google.com/recaptcha/api.js" async defer></script>
<script>
document.getElementById('membership-form').addEventListener('submit', async function(e) {
  e.preventDefault();
  
  // Basic form validation
  if (!this.checkValidity()) {
    e.stopPropagation();
    this.classList.add('was-validated');
    return;
  }
  
  // Get form data
  const formData = new FormData(this);
  
  // Get reCAPTCHA response
  const recaptchaResponse = grecaptcha.getResponse();
  formData.append('g-recaptcha-response', recaptchaResponse);
  
  // Show loading state
  document.getElementById('formResult').innerHTML = '<div class="alert alert-info">Processing your submission...</div>';
  
  try {
    const response = await fetch('https://4d0449f0-spring-sea-6ad5.jdx644pf8z.workers.dev', {
      method: 'POST',
      body: formData
    });
    
    const result = await response.text();
    
    if (response.ok) {
      document.getElementById('formResult').innerHTML = '<div class="alert alert-success">Thank you! Your membership application has been submitted successfully.</div>';
      this.reset();
      this.classList.remove('was-validated');
      grecaptcha.reset();
    } else {
      document.getElementById('formResult').innerHTML = `<div class="alert alert-danger">Error: ${result}</div>`;
    }
  } catch (error) {
    document.getElementById('formResult').innerHTML = '<div class="alert alert-danger">There was a problem submitting your form. Please try again later.</div>';
  }
});
</script>
	</body>
</html>
